<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AVR Liberty: encoder.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">AVR Liberty
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Library of routines for AVR microcontollers</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('encoder_8h.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">encoder.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Quadrature Encoder reader/driver.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="global_8h_source.html">global.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="encoderconf_8h_source.html">encoderconf.h</a>&quot;</code><br/>
</div>
<p><a href="encoder_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstruct___encoder_state.html">struct_EncoderState</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encoder state structure.  <a href="structstruct___encoder_state.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr class="memitem:aa02c46c3c011fea5dc710fd5d57cc4c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#aa02c46c3c011fea5dc710fd5d57cc4c9">IMSK</a>&#160;&#160;&#160;GIMSK</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a6f6ec5fd41d777896abbb574ee8989b3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structstruct___encoder_state.html">struct_EncoderState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#a6f6ec5fd41d777896abbb574ee8989b3">EncoderStateType</a></td></tr>
<tr class="memdesc:a6f6ec5fd41d777896abbb574ee8989b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encoder state structure.  <a href="#a6f6ec5fd41d777896abbb574ee8989b3"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa8c681c8b873261098816919e87bc51f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#aa8c681c8b873261098816919e87bc51f">encoderInit</a> (void)</td></tr>
<tr class="memdesc:aa8c681c8b873261098816919e87bc51f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#aa8c681c8b873261098816919e87bc51f" title="encoderInit() initializes hardware and encoder position readings">encoderInit()</a> initializes hardware and encoder position readings  <a href="#aa8c681c8b873261098816919e87bc51f"></a><br/></td></tr>
<tr class="memitem:a1502d3e77959dcf9000f779ca03e9410"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#a1502d3e77959dcf9000f779ca03e9410">encoderOff</a> (void)</td></tr>
<tr class="memdesc:a1502d3e77959dcf9000f779ca03e9410"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#a1502d3e77959dcf9000f779ca03e9410" title="encoderOff() disables hardware and stops encoder position updates">encoderOff()</a> disables hardware and stops encoder position updates  <a href="#a1502d3e77959dcf9000f779ca03e9410"></a><br/></td></tr>
<tr class="memitem:ac6883a27ed583125a9b0dde1860e0b8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#ac6883a27ed583125a9b0dde1860e0b8d">encoderGetPosition</a> (<a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a> encoderNum)</td></tr>
<tr class="memdesc:ac6883a27ed583125a9b0dde1860e0b8d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#ac6883a27ed583125a9b0dde1860e0b8d" title="encoderGetPosition() reads the current position of the encoder">encoderGetPosition()</a> reads the current position of the encoder  <a href="#ac6883a27ed583125a9b0dde1860e0b8d"></a><br/></td></tr>
<tr class="memitem:a1d9c9e24c6d8fa1dfa22a0bbf2823a28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#a1d9c9e24c6d8fa1dfa22a0bbf2823a28">encoderSetPosition</a> (<a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a> encoderNum, <a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a> position)</td></tr>
<tr class="memdesc:a1d9c9e24c6d8fa1dfa22a0bbf2823a28"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#a1d9c9e24c6d8fa1dfa22a0bbf2823a28" title="encoderSetPosition() sets the current position of the encoder">encoderSetPosition()</a> sets the current position of the encoder  <a href="#a1d9c9e24c6d8fa1dfa22a0bbf2823a28"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Quadrature Encoder reader/driver. </p>

<p>Definition in file <a class="el" href="encoder_8h_source.html">encoder.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa02c46c3c011fea5dc710fd5d57cc4c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="encoder_8h.html#aa02c46c3c011fea5dc710fd5d57cc4c9">IMSK</a>&#160;&#160;&#160;GIMSK</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="section user"><dt>Operation:</b></dt><dd>Quadrature encoders have two digital outputs usually called PhaseA and PhaseB. When the encoder rotates, PhaseA and PhaseB produce square wave pulses where each pulse represents a fraction of a turn of the encoder shaft. Encoders are rated for a certain number of pulses (or counts) per complete revolution of the shaft. Common counts/revolution specs are 50, 100,128,200,250,256,500,etc. By counting the number of pulses output on one of the phases starting from time0, you can calculate the total rotational distance the encoder has traveled.</dd></dl>
<p>Often, however, we want current position not just total distance traveled. For this it is necessary to know not only how far the encoder has traveled, but also which direction it was going at each step of the way. To do this we need to use both outputs (or phases) of the quadrature encoder.</p>
<p>The pulses from PhaseA and PhaseB on quadrature encoders are always aligned 90 degrees out-of-phase (otherwise said: 1/4 wavelength apart). This special phase relationship lets us extract both the distance and direction the encoder has rotated from the outputs.</p>
<p>To do this, consider Phase A to be the distance counter. On each rising edge of PhaseA we will count 1 "tic" of distance, but we need to know the direction. Look at the quadrature waveform plot below. Notice that when we travel forward in time (left-&gt;right), PhaseB is always low (logic 0) at the rising edge of PhaseA. When we travel backwards in time (right-&gt;left), PhaseB is always high (logic 1) at the rising edge of PhaseA. Note that traveling forward or backwards in time is the same thing as rotating forwards or bardwards. Thus, if PhaseA is our counter, PhaseB indicates direction.</p>
<p>Here is an example waveform from a quadrature encoder: To keep track of the encoder position in software, we connect PhaseA to an external processor interrupt line, and PhaseB to any I/O pin. We set up the external interrupt to trigger whenever PhaseA produces a rising edge. When a rising edge is detected, our interrupt handler function is executed. Inside the handler function, we quickly check the PhaseB line to see if it is high or low. If it is high, we increment the encoder's position counter, otherwise we decrement it. The encoder position counter can be read at any time to find out the current position. </p>

<p>Definition at line <a class="el" href="encoder_8h_source.html#l00110">110</a> of file <a class="el" href="encoder_8h_source.html">encoder.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a6f6ec5fd41d777896abbb574ee8989b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structstruct___encoder_state.html">struct_EncoderState</a>  <a class="el" href="encoder_8h.html#a6f6ec5fd41d777896abbb574ee8989b3">EncoderStateType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encoder state structure. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac6883a27ed583125a9b0dde1860e0b8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a> <a class="el" href="encoder_8h.html#ac6883a27ed583125a9b0dde1860e0b8d">encoderGetPosition</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a>&#160;</td>
          <td class="paramname"><em>encoderNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#ac6883a27ed583125a9b0dde1860e0b8d" title="encoderGetPosition() reads the current position of the encoder">encoderGetPosition()</a> reads the current position of the encoder </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00134">134</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa8c681c8b873261098816919e87bc51f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encoder_8h.html#aa8c681c8b873261098816919e87bc51f">encoderInit</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#aa8c681c8b873261098816919e87bc51f" title="encoderInit() initializes hardware and encoder position readings">encoderInit()</a> initializes hardware and encoder position readings </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00037">37</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1502d3e77959dcf9000f779ca03e9410"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encoder_8h.html#a1502d3e77959dcf9000f779ca03e9410">encoderOff</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#a1502d3e77959dcf9000f779ca03e9410" title="encoderOff() disables hardware and stops encoder position updates">encoderOff()</a> disables hardware and stops encoder position updates </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00112">112</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1d9c9e24c6d8fa1dfa22a0bbf2823a28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encoder_8h.html#a1d9c9e24c6d8fa1dfa22a0bbf2823a28">encoderSetPosition</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a>&#160;</td>
          <td class="paramname"><em>encoderNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a>&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#a1d9c9e24c6d8fa1dfa22a0bbf2823a28" title="encoderSetPosition() sets the current position of the encoder">encoderSetPosition()</a> sets the current position of the encoder </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00144">144</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="encoder_8h.html">encoder.h</a>      </li>

    <li class="footer">Generated on Wed Mar 28 2012 19:21:22 for AVR Liberty by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
